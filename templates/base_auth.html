{% set authed = session.get(''qualified'') %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}Semptify{% endblock %}</title>
  <style>
    :root { --brand:#667eea; --brandDark:#4f46e5; --bg:#0f172a; }
    * { box-sizing:border-box; }
    body { margin:0; font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif; background:#f6f7fb; color:#111827; }
    .topbar { position:sticky; top:0; z-index:50; background:#fff; border-bottom:1px solid #e5e7eb; }
    .wrap { max-width:1100px; margin:0 auto; padding:12px 20px; display:flex; align-items:center; gap:16px; }
    .brand { font-weight:800; letter-spacing:-0.4px; color:var(--brandDark); font-size:1.1rem; }
    nav { margin-left:auto; display:flex; gap:12px; }
    nav a { text-decoration:none; color:#374151; padding:8px 12px; border-radius:8px; font-weight:600; }
    nav a:hover { background:#eef2ff; color:var(--brandDark); }
    .cta { background:var(--brand); color:#fff !important; }
    main { max-width:1100px; margin:20px auto; padding:0 20px 40px; }
    footer { text-align:center; color:#6b7280; font-size:0.85rem; padding:24px; }
    /* Responsive breakpoints */
    @media (max-width: 640px) {
      nav { gap:8px; }
      nav a { padding:8px 10px; font-size:0.9rem; }
      .wrap { padding:10px 14px; }
      main { margin:14px auto; padding:0 14px 28px; }
    }
    @media (min-width: 1280px) { main { max-width: 1280px; } }
    @media (min-width: 1536px) { main { max-width: 1400px; } }
    @media (min-width: 1920px) { main { max-width: 1600px; } }
    /* Presentation mode */
    body.present main { max-width: 1800px; }
    body.present .wrap { max-width: 1800px; }
    body.present { font-size: 18px; }
  </style>
  {% block head %}{% endblock %}
</head>
<body>
  <header class="topbar">
    <div class="wrap">
      <div class="brand">Semptify</div>
      <nav>
        {% if authed %}
          <a href="/dashboard">Dashboard</a>
          <a href="/vault">Vault</a>
          <a href="/cards">Cards</a>
          <a href="/pages/research">Library</a>
          <a href="/settings">Settings</a>
        {% else %}
          <a href="/storage-setup" class="cta">Get Started</a>
          <a href="/vault-login">I have a token</a>
        {% endif %}
        <a href="#" id="togglePresent" title="Presentation mode">Presentation</a>
      </nav>
    </div>
  </header>
  <main>
    {% block content %}{% endblock %}
  </main>
  <footer>
    Â© {{ datetime.utcnow().year }} Semptify
  </footer>
  <script>
    (function(){
      const key = 'present-mode';
      const apply = (on) => {
        document.body.classList.toggle('present', !!on);
        const btn = document.getElementById('togglePresent');
        if (btn) btn.classList.toggle('cta', !!on);
      };
      try { apply(localStorage.getItem(key)==='1'); } catch(e){}
      document.addEventListener('click', (e) => {
        const t = e.target;
        if (t && t.id === 'togglePresent') { e.preventDefault();
          const on = !document.body.classList.contains('present');
          apply(on);
          try { localStorage.setItem(key, on ? '1' : '0'); } catch(e){}
        }
      });
    })();
  </script>
</body>
</html>
