<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Semptify - Command Center</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; background: #0a0a0a; color: #e0e0e0; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; box-shadow: 0 4px 20px rgba(102,126,234,0.3); }
        .header-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 2rem; font-weight: 700; color: white; }
        .profile-switcher { background: rgba(255,255,255,0.2); padding: 10px 20px; border-radius: 25px; display: flex; align-items: center; gap: 10px; cursor: pointer; }
        .profile-icon { width: 30px; height: 30px; border-radius: 50%; display: inline-block; }
        .container { max-width: 1400px; margin: 30px auto; padding: 0 20px; }
        .stats-bar { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .stat-card { background: #1a1a1a; padding: 20px; border-radius: 12px; border: 2px solid #333; }
        .stat-value { font-size: 2rem; font-weight: 700; color: #667eea; }
        .stat-label { color: #888; margin-top: 5px; }
        .section-title { font-size: 1.5rem; font-weight: 600; margin: 30px 0 20px; color: #fff; display: flex; align-items: center; gap: 10px; }
        .module-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .module-card { background: #1a1a1a; border: 2px solid #333; border-radius: 12px; padding: 20px; cursor: pointer; transition: all 0.3s; position: relative; overflow: hidden; }
        .module-card:hover { border-color: #667eea; transform: translateY(-5px); box-shadow: 0 10px 30px rgba(102,126,234,0.3); }
        .module-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: linear-gradient(90deg, #667eea, #764ba2); transform: scaleX(0); transition: transform 0.3s; }
        .module-card:hover::before { transform: scaleX(1); }
        .module-icon { font-size: 2.5rem; margin-bottom: 15px; }
        .module-name { font-size: 1.1rem; font-weight: 600; color: white; margin-bottom: 8px; }
        .module-desc { font-size: 0.9rem; color: #888; }
        .quick-actions { position: fixed; bottom: 30px; right: 30px; display: flex; flex-direction: column; gap: 15px; }
        .fab { width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); border: none; font-size: 1.5rem; cursor: pointer; box-shadow: 0 4px 20px rgba(102,126,234,0.5); transition: all 0.3s; display: flex; align-items: center; justify-content: center; color: white; }
        .fab:hover { transform: scale(1.1); box-shadow: 0 6px 30px rgba(102,126,234,0.7); }
        .ai-panel { position: fixed; right: -400px; top: 0; width: 400px; height: 100vh; background: #1a1a1a; border-left: 2px solid #667eea; padding: 20px; transition: right 0.3s; z-index: 1000; overflow-y: auto; }
        .ai-panel.open { right: 0; }
        .ai-close { float: right; font-size: 1.5rem; cursor: pointer; }
        .ai-input { width: 100%; padding: 15px; background: #0a0a0a; border: 1px solid #333; border-radius: 8px; color: #e0e0e0; font-family: inherit; margin-top: 20px; }
        .ai-button { width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea, #764ba2); border: none; border-radius: 8px; color: white; font-weight: 600; cursor: pointer; margin-top: 10px; }
        .ai-output { background: #0a0a0a; border: 1px solid #333; border-radius: 8px; padding: 15px; margin-top: 15px; max-height: 400px; overflow-y: auto; white-space: pre-wrap; font-family: 'Courier New', monospace; font-size: 0.9rem; }
        .badge { display: inline-block; padding: 4px 12px; border-radius: 12px; font-size: 0.75rem; font-weight: 600; background: #667eea; color: white; }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="logo">üè† Semptify Command Center</div>
            <div class="profile-switcher" onclick="window.location='/profiles'">
                <span class="profile-icon" style="background-color: {{ active_profile.color }}"></span>
                <div>
                    <div style="font-weight: 600; color: white;">{{ active_profile.name }}</div>
                    <div style="font-size: 0.8rem; color: rgba(255,255,255,0.7);">Click to switch</div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="stats-bar">
            <div class="stat-card">
                <div class="stat-value" id="stat-documents">--</div>
                <div class="stat-label">Documents</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ all_profiles|length }}</div>
                <div class="stat-label">Active Cases</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-ai">--</div>
                <div class="stat-label">AI Models</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-storage">--</div>
                <div class="stat-label">Storage</div>
            </div>
        </div>

        <div class="section-title">üìÅ Document Management</div>
        <div class="module-grid">
            {% for module in modules.documents %}
            <div class="module-card" onclick="window.location='{{ module.url }}'">
                <div class="module-icon">{{ module.icon }}</div>
                <div class="module-name">{{ module.name }}</div>
                <div class="module-desc">{{ module.desc }}</div>
            </div>
            {% endfor %}
        </div>

        <div class="section-title">‚öñÔ∏è Legal Tools</div>
        <div class="module-grid">
            {% for module in modules.legal %}
            <div class="module-card" onclick="window.location='{{ module.url }}'">
                <div class="module-icon">{{ module.icon }}</div>
                <div class="module-name">{{ module.name }}</div>
                <div class="module-desc">{{ module.desc }}</div>
            </div>
            {% endfor %}
        </div>

        <div class="section-title">üí∞ Financial Tracking</div>
        <div class="module-grid">
            {% for module in modules.financial %}
            <div class="module-card" onclick="window.location='{{ module.url }}'">
                <div class="module-icon">{{ module.icon }}</div>
                <div class="module-name">{{ module.name }}</div>
                <div class="module-desc">{{ module.desc }}</div>
            </div>
            {% endfor %}
        </div>

        <div class="section-title">üìÖ Timeline & Calendar</div>
        <div class="module-grid">
            {% for module in modules.timeline %}
            <div class="module-card" onclick="window.location='{{ module.url }}'">
                <div class="module-icon">{{ module.icon }}</div>
                <div class="module-name">{{ module.name }}</div>
                <div class="module-desc">{{ module.desc }}</div>
            </div>
            {% endfor %}
        </div>

        <div class="section-title">ü§ñ AI & Learning</div>
        <div class="module-grid">
            {% for module in modules.ai %}
            <div class="module-card" onclick="window.location='{{ module.url }}'">
                <div class="module-icon">{{ module.icon }}</div>
                <div class="module-name">{{ module.name }} <span class="badge">NEW</span></div>
                <div class="module-desc">{{ module.desc }}</div>
            </div>
            {% endfor %}
        </div>

        <div class="section-title">‚öôÔ∏è System & Admin</div>
        <div class="module-grid">
            {% for module in modules.admin %}
            <div class="module-card" onclick="window.location='{{ module.url }}'">
                <div class="module-icon">{{ module.icon }}</div>
                <div class="module-name">{{ module.name }}</div>
                <div class="module-desc">{{ module.desc }}</div>
            </div>
            {% endfor %}
        </div>
    </div>

    <div class="quick-actions">
        <button class="fab" onclick="toggleAIPanel()" title="AI Development Assistant">ü§ñ</button>
        <button class="fab" onclick="window.location='/profiles'" title="Switch Profile">üë•</button>
        <button class="fab" onclick="window.location='/vault'" title="Quick Upload">üìÅ</button>
    </div>

    <div class="ai-panel" id="aiPanel">
        <span class="ai-close" onclick="toggleAIPanel()">√ó</span>
        <h2>ü§ñ AI Development Assistant</h2>
        <p style="color: #888; margin-top: 10px;">Build new features with AI help</p>
        
        <textarea class="ai-input" id="featureInput" rows="4" placeholder="Describe the feature you want to build...
Example: Create a notes system where I can add timestamped notes to each case"></textarea>
        
        <button class="ai-button" onclick="generateFeature()">Generate Code</button>
        <button class="ai-button" onclick="startChat()" style="background: #333;">Chat with AI</button>
        
        <div class="ai-output" id="aiOutput" style="display: none;"></div>
    </div>

    <script>
        // Load stats
        fetch('/gui/api/stats')
            .then(r => r.json())
            .then(data => {
                document.getElementById('stat-documents').textContent = data.documents;
                document.getElementById('stat-ai').textContent = data.ai_models;
                document.getElementById('stat-storage').textContent = data.storage;
            });

        function toggleAIPanel() {
            document.getElementById('aiPanel').classList.toggle('open');
        }

        async function generateFeature() {
            const description = document.getElementById('featureInput').value;
            const output = document.getElementById('aiOutput');
            output.style.display = 'block';
            output.textContent = 'Generating code...';

            try {
                const response = await fetch('/gui/ai-dev/generate', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({description})
                });
                const data = await response.json();
                
                if (data.success) {
                    output.textContent = JSON.stringify(data.code, null, 2);
                } else {
                    output.textContent = 'Error: ' + data.error;
                }
            } catch (e) {
                output.textContent = 'Error: ' + e.message;
            }
        }

        function startChat() {
            alert('Chat interface coming soon! Use the feature generator for now.');
        }
    </script>
</body>
</html>
