{% extends "base_auth.html" %}

{% block content %}
<style>
    .storage-container { max-width: 900px; margin: 40px auto; padding: 0 20px; }
    .storage-header { text-align: center; margin-bottom: 40px; }
    .storage-header h1 { font-size: 2rem; color: #333; margin-bottom: 12px; }
    .storage-header p { font-size: 1.1rem; color: #666; }
    
    .storage-options { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 32px; }
    @media (max-width: 768px) { .storage-options { grid-template-columns: 1fr; } }
    
    .storage-option { background: white; border-radius: 12px; padding: 32px; cursor: pointer; border: 3px solid #e5e7eb; transition: all 0.2s; position: relative; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    .storage-option:hover { transform: translateY(-4px); box-shadow: 0 12px 32px rgba(0,0,0,0.15); border-color: var(--brand); }
    .storage-option.selected { border-color: var(--brand); box-shadow: 0 0 0 4px rgba(102,126,234,0.2); background: #f8f9ff; }
    .storage-option input[type=radio] { position: absolute; opacity: 0; }
    
    .option-header { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
    .option-icon { font-size: 2.5rem; }
    .option-title { font-size: 1.4rem; font-weight: 700; color: #222; }
    .badge { display: inline-block; background: #10b981; color: white; padding: 4px 10px; border-radius: 8px; font-size: 0.75rem; font-weight: 600; margin-left: auto; }
    
    .option-features { list-style: none; margin: 16px 0; }
    .option-features li { padding: 8px 0; color: #555; font-size: 0.95rem; display: flex; align-items: center; gap: 8px; }
    .option-features li::before { content: 'âœ“'; color: #10b981; font-weight: 700; font-size: 1.2rem; }
    .option-note { font-size: 0.85rem; color: #888; margin-top: 12px; font-style: italic; }
    
    .storage-cta { text-align: center; }
    .btn-continue { display: inline-block; background: var(--brand); color: white; padding: 16px 48px; border-radius: 8px; font-size: 1.1rem; font-weight: 600; border: none; cursor: pointer; box-shadow: 0 4px 12px rgba(102,126,234,0.3); transition: all 0.2s; text-decoration: none; }
    .btn-continue:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(102,126,234,0.4); background: var(--brandDark); }
    .btn-continue:disabled { opacity: 0.5; cursor: not-allowed; }
</style>

<div class="storage-container">
    <div class="storage-header">
        <h1>Choose Your Storage Provider</h1>
        <p>Select where you'd like to securely store your evidence and documents</p>
    </div>

    <form id="storageForm" action="/storage-setup" method="POST">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
        
                <div class="storage-options">
            <label class="storage-option" data-provider="google_drive">
                <input type="radio" name="provider" value="google_drive" required>
                <div class="option-header">
                    <span class="option-icon">ðŸŸ¦</span>
                    <span class="option-title">Google Drive</span>
                    <span class="badge">Recommended</span>
                </div>
                <ul class="option-features">
                    <li>One encrypted file (.semptify/calendar.enc)</li>
                    <li>OAuth keeps token hidden (no manual keys)</li>
                    <li>Tamper-proof doc IDs & chain-of-custody</li>
                    <li>Works across devices automatically</li>
                    <li>Hidden .semptify folder created on first connect</li>
                </ul>
                <div class="option-note">Fast setup. No developer console complexity for users.</div>
            </label>

            <label class="storage-option" data-provider="dropbox">
                <input type="radio" name="provider" value="dropbox">
                <div class="option-header">
                    <span class="option-icon">ðŸ“¦</span>
                    <span class="option-title">Dropbox</span>
                </div>
                <ul class="option-features">
                    <li>Desktop sync + encrypted single file</li>
                    <li>Hidden .semptify folder isolates evidence</li>
                    <li>Tamper detection & certificates baked in</li>
                    <li>No passwords stored locally</li>
                    <li>Cross-device continuity out of the box</li>
                </ul>
                <div class="option-note">Great if you already use Dropbox sync.</div>
            </label>
        </div>

        <div class="storage-cta">
            <button type="submit" class="btn-continue" id="continueBtn" disabled>Continue with Selected Provider</button>
        </div>
            
</form>
</div>

<script>
document.querySelectorAll('.storage-option').forEach(option => {
    option.addEventListener('click', function() {
        document.querySelectorAll('.storage-option').forEach(o => o.classList.remove('selected'));
        this.classList.add('selected');
        this.querySelector('input[type=radio]').checked = true;
        document.getElementById('continueBtn').disabled = false;
    });
});

document.getElementById('continueBtn').addEventListener('click', function(e) {
    e.preventDefault();
    const selected = document.querySelector('input[name="provider"]:checked');
    if (selected) {
        const provider = selected.value;
        if (provider === 'google_drive') {
            window.location.href = '/oauth/google/start';
        } else if (provider === 'dropbox') {
            window.location.href = '/oauth/dropbox/start';
        }
    }
});
</script>
{% endblock %}




